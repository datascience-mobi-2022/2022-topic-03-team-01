---
title: "Proteome-wide Screen for RNA-dependent Proteins in Non-Synchronized
  HeLa cells"
author: "Alisa Kirkin, Sina KÃ¼hnel, Ignacio Lozano Onrubia, Greta Pick"
date: "19/07/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Final Report

Idee: vielleicht keine 1-bla Nummerierung, sondern Aufteilung in Phase 1-5 und dann Unterpunkte mit Header2

# 1. Introduction

Cancer, neurological diseases and muscular atrophy - What do these diseases have in common? 
All of them include RNA-binding proteins. RNA-binding proteins (RBP) are proteins that bind RNA and form ribonucleoprotein particles. They are involved in a number of processes like translation, alternative splicing, RNA editing and chemical modification as well as protein modification. RBPs belong to the RNA-dependent proteins (RDP) togehter with RBP-binding proteins. These RBP-binding proteins bind RBPs when they assemble with RNA. Their complex interactions are crucial for cellular functions and therefore it is of importance to identify RDPs.


## 1.1 Summary of experiment
To identify RDPs a proteom-wide screen was conducted with mass-spectometry. HeLa S3 cels in different cell cycle stages were lysed (Fig. 1). The cell lysate was split into a control and an RNase gropup. The RNase group was treated with RNase which causes the degradation of RNase. RBPs can no longer bind to RNA and RBP-binding proteins to RBPs. The control group did not receive any further treatment and therefore all RNA and RDPs interact. The cell lysate was transferred onto a sucrose density gradient. After ultra centrifugation the RNA-protein complexes or proteins alone will end up in one of 25 fractions depending on their molecular weight. A heavy RNA-protein complex will travel further and land in a higher fraction than a single protein from the RNase treatment. This would create a left shift and is expected to happen for RDPs.

![***Figure 1*: Generation of Data.**](/Users/gretapick/Documents/Studium/4. Semester/Bioinformatik/Experiment.png)

## 1.2 Goals
The main goal is to automatically identify RDPs on the basis of the fraction shift between control and RNase treatment. 

# 2. Description of the Dataset
The dataset consists of 4765 rows which represent different proteins and 150 columns. Those include 3 replica for each of the 25 fractions for control and RNase treatment (3 x 25 x 2 = 150 columns). For every protein the protein amount in a certain fraction is given in arbitrary units.

Include graphs before Normalization?

# 3. Data Clean Up and Normalization 
Clean Up of the raw data is needed for the following analysis. 
First we split our dataset into two dataframes containing only the control and RNase group. Those were split further into three subtables representing the three reps. A protein was deleted from control and RNase when it had no counts in at least one rep. Eight proteins were deleted, becuase they had at least one all zero row in one rep.

##3.1 Normalization 
Goal of the normalization is to make the three different reps more similar by applying statistical and mathematical functions.

a) Repwise Normalization 
For simpler calculation we created subtables seperately for control and RNase containing only one fraction with all three reps (for both control and RNase group 50 subtables were created). For every subtable the mean over all the proteins for every rep from one fraction was calculated, creating 3 mean values in for each of the 50 subtables. 
The function *smallest diff* was created to find the two reps for every individual fraction with the smallest difference of their mean values. The mean value of these two reps over all the proteins from one fraction was determined. The normalization factors for every fraction for each rep was calculated by dividing the mean from the most similar two reps by the individual means of one fraction for each rep (for each of the 50 subtables containing one fraction with three reps, three normalization factors were determined). By multiplying all the values of one fraction of one rep with its individual normalization factor, we received the normalized values for all reps and for both control and RNase group.
When comparing the unnormed values with the normalized values by summing up all the proteins of all fraction for each rap, it is noticably how the reps have been statistically adjusted. 

```{r}
ctrl1 = cbind(ctrl.matrix[,seq(1,75,3)])
ctrl2 = cbind(ctrl.matrix[,seq(2,75,3)])
ctrl3 = cbind(ctrl.matrix[,seq(3,75,3)])
rnase1=cbind(rnase.matrix[, seq(1,75,3)])
rnase2=cbind(rnase.matrix[, seq(2,75,3)])
rnase3=cbind(rnase.matrix[, seq(3,75,3)])

ctrl.sums=cbind(sum(norm.ctrl1),sum(norm.ctrl2),sum(norm.ctrl3),sum(ctrl1),sum(ctrl2),sum(ctrl3))
colnames(ctrl.sums)=c("norm.ctrl1", "norm.ctrl2", "norm.ctrl3", "ctrl1", "ctrl2", "ctrl3")
barplot(ctrl.sums, xlab="Control samples of normalized and unnormalized data", ylab="protein amount")

rnase.sums=cbind(sum(norm.rnase1),sum(norm.rnase2),sum(norm.rnase3),sum(rnase1),sum(rnase2),sum(rnase3))
colnames(rnase.sums)=c("norm.rnase1","norm.rnase2", "norm.rnase3", "rnase1", "rnase2", "rnase3")
barplot(rnase.sums, xlab="RNase samples of normalized and unnormalized data", ylab="protein amount")

```
 
b) Fraction-wise Normalization - Scaling

##3.2 Reproducibility
The three reps for control and RNAse group were adjusted during normalization. Nontheless, it is possible that they differ too much in order to be used in further analysis. Therefore we examined the reproducibility of the reps with correlation. First the normalized data was transformed so that the columns consist of proteins and rows of the different protein amounts in each fraction. We created the function *low.cor* that first calculates the pearson correlation over all fractions of each protein of two reps. It returns only the column numbers of proteins which reps have a correlation coefficient beneath 0.7. By applying *low.cor* six times (rep1 & rep2, rep1 & rep3, rep2 & rep3 for control and RNase) we could create a dataframe that contains only proteins with low correlation and includes how often a protein did not correlate well. 
Proteins that have a low correlation coefficient two or three times (three times meaning that no rep correlates well) are deleted.

# 4. Maxima  

## 4.1 Smoothing the Curve


## 4.2 Identification of global Maxima


## 4.3 Gauss fitting to the Curve











```{r pressure, echo=FALSE}

```



---
title: "Bioinfoprojekt HeLa cells"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
MS_Table <- read.table("/Users/gretapick/Documents/Studium/4. Semester/Bioinformatik/RDeeP_HeLa_NS.csv", header=TRUE, row.names=1, sep = ";")

#str(MS_Table)
#subset( MS_Table, subset= var(x,y = NULL))
```

```{r}
#1. Clean Up and Normalization
#1.1 Split dataset into 2 datasets. One dataset consists only of Control group and the other of RNase.

ctrl_matrix= cbind(MS_Table[, seq(1,150,2)])
rnase_matrix=cbind(MS_Table[, seq(1,150,2)])

#1.2 Removing all zero rows
ctrl_matrix[rowSums(ctrl_matrix[])>0,]
rnase_matrix[rowSums(ctrl_matrix[])>0,]

#1.3 Normalization
#Loopen mit sapply
ctrl.frc1=cbind(ctrl_matrix[,1:3])
ctrl.frc2=cbind(ctrl_matrix[,4:6])
ctrl.frc3=cbind(ctrl_matrix[,7:9])
ctrl.frc4=cbind(ctrl_matrix[,10:12])
ctrl.frc5=cbind(ctrl_matrix[,13:15])
ctrl.frc6=cbind(ctrl_matrix[,16:18])
ctrl.frc7=cbind(ctrl_matrix[,19:21])
ctrl.frc8=cbind(ctrl_matrix[,22:24])
ctrl.frc9=cbind(ctrl_matrix[,25:27])
ctrl.frc10=cbind(ctrl_matrix[,28:30])
ctrl.frc11=cbind(ctrl_matrix[,31:33])
ctrl.frc12=cbind(ctrl_matrix[,34:36])
ctrl.frc13=cbind(ctrl_matrix[,37:39])
ctrl.frc14=cbind(ctrl_matrix[,40:42])
ctrl.frc15=cbind(ctrl_matrix[,43:45])
ctrl.frc16=cbind(ctrl_matrix[,46:48])
ctrl.frc17=cbind(ctrl_matrix[,49:51])
ctrl.frc18=cbind(ctrl_matrix[,52:54])
ctrl.frc19=cbind(ctrl_matrix[,55:57])
ctrl.frc20=cbind(ctrl_matrix[,58:60])
ctrl.frc21=cbind(ctrl_matrix[,61:63])
ctrl.frc22=cbind(ctrl_matrix[,64:66])
ctrl.frc23=cbind(ctrl_matrix[,67:69])
ctrl.frc24=cbind(ctrl_matrix[,70:72])
ctrl.frc25=cbind(ctrl_matrix[,73:75])

#mean von rep1, rep2, rep3
mean.ctrl.frc1=apply(ctrl.frc1,2,function(x){mean(x)})
mean.ctrl.frc2=apply(ctrl.frc2,2,function(x){mean(x)})
mean.ctrl.frc3=apply(ctrl.frc3,2,function(x){mean(x)})
mean.ctrl.frc4=apply(ctrl.frc4,2,function(x){mean(x)})
mean.ctrl.frc5=apply(ctrl.frc5,2,function(x){mean(x)})
mean.ctrl.frc6=apply(ctrl.frc6,2,function(x){mean(x)})
mean.ctrl.frc7=apply(ctrl.frc7,2,function(x){mean(x)})
mean.ctrl.frc8=apply(ctrl.frc8,2,function(x){mean(x)})
mean.ctrl.frc9=apply(ctrl.frc9,2,function(x){mean(x)})
mean.ctrl.frc10=apply(ctrl.frc10,2,function(x){mean(x)})
mean.ctrl.frc11=apply(ctrl.frc11,2,function(x){mean(x)})
mean.ctrl.frc12=apply(ctrl.frc12,2,function(x){mean(x)})
mean.ctrl.frc13=apply(ctrl.frc13,2,function(x){mean(x)})
mean.ctrl.frc14=apply(ctrl.frc14,2,function(x){mean(x)})
mean.ctrl.frc15=apply(ctrl.frc15,2,function(x){mean(x)})
mean.ctrl.frc16=apply(ctrl.frc16,2,function(x){mean(x)})
mean.ctrl.frc17=apply(ctrl.frc17,2,function(x){mean(x)})
mean.ctrl.frc18=apply(ctrl.frc18,2,function(x){mean(x)})
mean.ctrl.frc19=apply(ctrl.frc19,2,function(x){mean(x)})
mean.ctrl.frc20=apply(ctrl.frc20,2,function(x){mean(x)})
mean.ctrl.frc21=apply(ctrl.frc21,2,function(x){mean(x)})
mean.ctrl.frc22=apply(ctrl.frc22,2,function(x){mean(x)})
mean.ctrl.frc23=apply(ctrl.frc23,2,function(x){mean(x)})
mean.ctrl.frc24=apply(ctrl.frc24,2,function(x){mean(x)})
mean.ctrl.frc25=apply(ctrl.frc25,2,function(x){mean(x)})

#function "small.diff" find reps with smallest difference of the means
norm.mean = function(x) {
  diff.rep1.rep2=abs(x[1]-x[2])
  diff.rep1.rep3=abs(x[1]-x[3])
  diff.rep2.rep3=abs(x[2]-x[3])
  
  if(diff.rep1.rep2<diff.rep1.rep3 && diff.rep1.rep2<diff.rep2.rep3) {
    #print("rep1 and rep2")
    mean(c(x[1],x[2]))
  }else if (diff.rep1.rep3<diff.rep1.rep2 && diff.rep1.rep3<diff.rep2.rep3) {
  #print("rep1 and rep3")
  mean(c(x[1],x[3]))
} else { 
 # print("rep2 and rep3")
  mean(c(x[2],x[3]))
  }
}

#compute normalization factor 
norm.fact.ctrl.frc1=norm.mean(mean.ctrl.frc1)/mean.ctrl.frc1
norm.fact.ctrl.frc2=norm.mean(mean.ctrl.frc2)/mean.ctrl.frc2
norm.fact.ctrl.frc3=norm.mean(mean.ctrl.frc3)/mean.ctrl.frc3
norm.fact.ctrl.frc4=norm.mean(mean.ctrl.frc4)/mean.ctrl.frc4
norm.fact.ctrl.frc5=norm.mean(mean.ctrl.frc5)/mean.ctrl.frc5
norm.fact.ctrl.frc6=norm.mean(mean.ctrl.frc6)/mean.ctrl.frc6
norm.fact.ctrl.frc7=norm.mean(mean.ctrl.frc7)/mean.ctrl.frc7
norm.fact.ctrl.frc8=norm.mean(mean.ctrl.frc8)/mean.ctrl.frc8
norm.fact.ctrl.frc9=norm.mean(mean.ctrl.frc9)/mean.ctrl.frc9
norm.fact.ctrl.frc10=norm.mean(mean.ctrl.frc10)/mean.ctrl.frc10
norm.fact.ctrl.frc11=norm.mean(mean.ctrl.frc11)/mean.ctrl.frc11
norm.fact.ctrl.frc12=norm.mean(mean.ctrl.frc12)/mean.ctrl.frc12
norm.fact.ctrl.frc13=norm.mean(mean.ctrl.frc13)/mean.ctrl.frc13
norm.fact.ctrl.frc14=norm.mean(mean.ctrl.frc14)/mean.ctrl.frc14
norm.fact.ctrl.frc15=norm.mean(mean.ctrl.frc15)/mean.ctrl.frc15
norm.fact.ctrl.frc16=norm.mean(mean.ctrl.frc16)/mean.ctrl.frc16
norm.fact.ctrl.frc17=norm.mean(mean.ctrl.frc17)/mean.ctrl.frc17
norm.fact.ctrl.frc18=norm.mean(mean.ctrl.frc18)/mean.ctrl.frc18
norm.fact.ctrl.frc19=norm.mean(mean.ctrl.frc19)/mean.ctrl.frc19
norm.fact.ctrl.frc20=norm.mean(mean.ctrl.frc20)/mean.ctrl.frc20
norm.fact.ctrl.frc21=norm.mean(mean.ctrl.frc21)/mean.ctrl.frc21
norm.fact.ctrl.frc22=norm.mean(mean.ctrl.frc22)/mean.ctrl.frc22
norm.fact.ctrl.frc23=norm.mean(mean.ctrl.frc23)/mean.ctrl.frc23
norm.fact.ctrl.frc24=norm.mean(mean.ctrl.frc24)/mean.ctrl.frc24
norm.fact.ctrl.frc25=norm.mean(mean.ctrl.frc25)/mean.ctrl.frc25

#normed values for control
norm.ctrl.frc1=ctrl.frc1*norm.fact.ctrl.frc1
norm.ctrl.frc2=ctrl.frc2*norm.fact.ctrl.frc2
norm.ctrl.frc3=ctrl.frc3*norm.fact.ctrl.frc3
norm.ctrl.frc4=ctrl.frc4*norm.fact.ctrl.frc4
norm.ctrl.frc5=ctrl.frc5*norm.fact.ctrl.frc5
norm.ctrl.frc6=ctrl.frc6*norm.fact.ctrl.frc6
norm.ctrl.frc7=ctrl.frc7*norm.fact.ctrl.frc7
norm.ctrl.frc8=ctrl.frc8*norm.fact.ctrl.frc8
norm.ctrl.frc9=ctrl.frc9*norm.fact.ctrl.frc9
norm.ctrl.frc10=ctrl.frc10*norm.fact.ctrl.frc10
norm.ctrl.frc11=ctrl.frc11*norm.fact.ctrl.frc11
norm.ctrl.frc12=ctrl.frc12*norm.fact.ctrl.frc12
norm.ctrl.frc13=ctrl.frc13*norm.fact.ctrl.frc13
norm.ctrl.frc14=ctrl.frc14*norm.fact.ctrl.frc14
norm.ctrl.frc15=ctrl.frc15*norm.fact.ctrl.frc15
norm.ctrl.frc16=ctrl.frc16*norm.fact.ctrl.frc16
norm.ctrl.frc17=ctrl.frc17*norm.fact.ctrl.frc17
norm.ctrl.frc18=ctrl.frc18*norm.fact.ctrl.frc18
norm.ctrl.frc19=ctrl.frc19*norm.fact.ctrl.frc19
norm.ctrl.frc20=ctrl.frc20*norm.fact.ctrl.frc20
norm.ctrl.frc21=ctrl.frc21*norm.fact.ctrl.frc21
norm.ctrl.frc22=ctrl.frc22*norm.fact.ctrl.frc22
norm.ctrl.frc23=ctrl.frc23*norm.fact.ctrl.frc23
norm.ctrl.frc24=ctrl.frc24*norm.fact.ctrl.frc24
norm.ctrl.frc25=ctrl.frc25*norm.fact.ctrl.frc25

```







```

